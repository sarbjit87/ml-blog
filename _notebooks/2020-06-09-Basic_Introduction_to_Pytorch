{"cells":[{"metadata":{"_uuid":"d629ff2d2480ee46fbb7e2d37f6b5fab8052498a","collapsed":true,"_cell_guid":"79c7e3d0-c299-4dcb-8224-4455121ee9b0","trusted":false},"cell_type":"markdown","source":"**What is Pytorch?**\n\nPytorch is an open-source machine learning library developed by Facebook. It allows flexibility and speed for scientific computing for deep learning. Consider it as a replacement of Numpy so that the GPU capability can be used."},{"metadata":{},"cell_type":"markdown","source":"**Tensors?**\n\nTensor is the core element of Pytorch and are basically a n-dimensional data container much like Numpy's n-dimensional array. A tensor could be a number, vector, matrix or a n-dimensional array."},{"metadata":{"trusted":true},"cell_type":"code","source":"import torch\n\n# Scalar - Integer\nt1 = torch.tensor(5)\nprint(\"Tensor is {} with shape {} and data type {}\".format(t1, t1.shape, t1.dtype))","execution_count":10,"outputs":[{"output_type":"stream","text":"Tensor is 5 with shape torch.Size([]) and data type torch.int64\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"# Scalar - Float\nt2 = torch.tensor(5.)\nprint(\"Tensor is {} with shape {} and data type {}\".format(t2, t2.shape, t2.dtype))","execution_count":11,"outputs":[{"output_type":"stream","text":"Tensor is 5.0 with shape torch.Size([]) and data type torch.float32\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"# Vector\nt3 = torch.tensor([1., 2, 3])\nprint(\"Tensor is {} with shape {} and data type {}\".format(t3, t3.shape, t3.dtype))\n\nt4 = torch.tensor([1, 2, 3])\nprint(\"Tensor is {} with shape {} and data type {}\".format(t4, t4.shape, t4.dtype))","execution_count":13,"outputs":[{"output_type":"stream","text":"Tensor is tensor([1., 2., 3.]) with shape torch.Size([3]) and data type torch.float32\nTensor is tensor([1, 2, 3]) with shape torch.Size([3]) and data type torch.int64\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"# Matrix\nt5 = torch.tensor([[1., 2, 3],[4, 5, 6]])\nprint(\"Tensor is {} with shape {} and data type {}\".format(t5, t5.shape, t5.dtype))\n\nt6 = torch.tensor([[1, 2, 3],[4, 5, 6]])\nprint(\"Tensor is {} with shape {} and data type {}\".format(t6, t6.shape, t6.dtype))","execution_count":15,"outputs":[{"output_type":"stream","text":"Tensor is tensor([[1., 2., 3.],\n        [4., 5., 6.]]) with shape torch.Size([2, 3]) and data type torch.float32\nTensor is tensor([[1, 2, 3],\n        [4, 5, 6]]) with shape torch.Size([2, 3]) and data type torch.int64\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"*Creating tensors using torch.Tensor & torch.tensor :*\n\ntorch.Tensor is the main Tensor class and everything is an instance of it. You can use it to create an empty tensor which is not possible with torch.tensor.  "},{"metadata":{"trusted":true},"cell_type":"code","source":"# Creating tensors using torch.Tensor class \n\n# Create a tensor with 3 elements and random data\nt7 = torch.Tensor(3)\nprint(\"Tensor is {} with shape {} and data type {}\".format(t7, t7.shape, t7.dtype))\n\n# Matrix - 2X3 with random data\nt8 = torch.Tensor(2, 3)\nprint(\"Tensor is {} with shape {} and data type {}\".format(t8, t8.shape, t8.dtype))\n\n# 2X3 Matrix with data\nt9 = torch.Tensor([[1, 2], [3, 4]])\nprint(\"Tensor is {} with shape {} and data type {}\".format(t9, t9.shape, t9.dtype))","execution_count":18,"outputs":[{"output_type":"stream","text":"Tensor is tensor([-1.7170e+16,  3.0736e-41, -1.7137e+16]) with shape torch.Size([3]) and data type torch.float32\nTensor is tensor([[-1.7170e+16,  3.0736e-41, -1.7171e+16],\n        [ 3.0736e-41,  8.9683e-44,  0.0000e+00]]) with shape torch.Size([2, 3]) and data type torch.float32\nTensor is tensor([[1., 2.],\n        [3., 4.]]) with shape torch.Size([2, 2]) and data type torch.float32\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"# Arithemetic operations\n\na = torch.tensor(1)\nb = torch.tensor(2)\nc = torch.tensor(3)\ny = a + b + c\nprint(y)\n\n# Derivatives \na = torch.tensor(1.)\nb = torch.tensor(2., requires_grad=True)\nc = torch.tensor(3., requires_grad=True)\ny = a + b + c\nprint(y)\n","execution_count":22,"outputs":[{"output_type":"stream","text":"tensor(6)\ntensor(6., grad_fn=<AddBackward0>)\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"Pytorch allows you to not only run the tensors in CPU but also in GPU for speed. Also, it got some unique features to track operations applied on them by forming backward graph for the tensors having requires_grad property set to True. \n\nSo basically, you can calculate the derivative of the \"y\" with respect to the other tensors having requires_grad by calling .backward method. Derivative is stored in a variable .grad associated with each tensor."},{"metadata":{"trusted":true},"cell_type":"code","source":"y.backward()\n\nprint('dy/da:', a.grad)\nprint('dy/db:', b.grad)\nprint('dy/dc:', c.grad)","execution_count":24,"outputs":[{"output_type":"stream","text":"dy/da: None\ndy/db: tensor(2.)\ndy/dc: tensor(2.)\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"**Numpy and Pytorch**\n\nWe can quickly create tensors from Numpy arrays.\n"},{"metadata":{"trusted":true},"cell_type":"code","source":"import numpy as np\n\n# Convert Numpy array to tensor\n\na1 = np.array([[1, 2, 4.], [5, 6, 7]])\n\nt = torch.from_numpy(a1)\n\nprint(\"Tensor is {} with shape {} and data type {}\".format(t, t.shape, t.dtype))","execution_count":27,"outputs":[{"output_type":"stream","text":"Tensor is tensor([[1., 2., 4.],\n        [5., 6., 7.]], dtype=torch.float64) with shape torch.Size([2, 3]) and data type torch.float64\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"# Convert tensor to Numpy array\n\na2 = t.numpy()\nprint(a2)","execution_count":28,"outputs":[{"output_type":"stream","text":"[[1. 2. 4.]\n [5. 6. 7.]]\n","name":"stdout"}]}],"metadata":{"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"language_info":{"name":"python","version":"3.7.6","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"}},"nbformat":4,"nbformat_minor":4}